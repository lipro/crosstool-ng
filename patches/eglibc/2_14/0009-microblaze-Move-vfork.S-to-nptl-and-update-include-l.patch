From 40a26c49ad2fe9be40706faa79c28061f9be8de7 Mon Sep 17 00:00:00 2001
From: David Holsgrove <david.holsgrove@petalogix.com>
Date: Thu, 26 Jan 2012 09:37:25 +1000
Subject: [PATCH 09/41] microblaze: Move vfork.S to nptl and update include location in pt-vfork.S

Signed-off-by: David Holsgrove <david.holsgrove@petalogix.com>
---
 nptl/sysdeps/unix/sysv/linux/microblaze/pt-vfork.S |    2 +-
 nptl/sysdeps/unix/sysv/linux/microblaze/vfork.S    |   45 ++++++++++++++++++++
 sysdeps/unix/sysv/linux/microblaze/vfork.S         |   45 --------------------
 3 files changed, 46 insertions(+), 46 deletions(-)
 create mode 100644 nptl/sysdeps/unix/sysv/linux/microblaze/vfork.S
 delete mode 100644 sysdeps/unix/sysv/linux/microblaze/vfork.S

diff --git a/nptl/sysdeps/unix/sysv/linux/microblaze/pt-vfork.S b/nptl/sysdeps/unix/sysv/linux/microblaze/pt-vfork.S
index fffed89..5e114c0 100644
--- a/nptl/sysdeps/unix/sysv/linux/microblaze/pt-vfork.S
+++ b/nptl/sysdeps/unix/sysv/linux/microblaze/pt-vfork.S
@@ -18,4 +18,4 @@
 
 #include <tcb-offsets.h>
 
-#include "../vfork.S"
+#include "vfork.S"
diff --git a/nptl/sysdeps/unix/sysv/linux/microblaze/vfork.S b/nptl/sysdeps/unix/sysv/linux/microblaze/vfork.S
new file mode 100644
index 0000000..ca99596
--- /dev/null
+++ b/nptl/sysdeps/unix/sysv/linux/microblaze/vfork.S
@@ -0,0 +1,45 @@
+/* The GNU C Library is free software; you can redistribute it and/or
+   modify it under the terms of the GNU Lesser General Public
+   License as published by the Free Software Foundation; either
+   version 2.1 of the License, or (at your option) any later version.
+
+   The GNU C Library is distributed in the hope that it will be useful,
+   but WITHOUT ANY WARRANTY; without even the implied warranty of
+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+   Lesser General Public License for more details.
+
+   You should have received a copy of the GNU Lesser General Public
+   License along with the GNU C Library; if not, write to the Free
+   Software Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA
+   02111-1307 USA.  */
+
+#include <sysdep.h>
+#define _ERRNO_H	1
+#include <bits/errno.h>
+#include <kernel-features.h>
+
+/* Clone the calling process, but without copying the whole address space.
+   The calling process is suspended until the new process exits or is
+   replaced by a call to `execve'.  Return -1 for errors, 0 to the new process,
+   and the process ID of the new process to the old process.  */
+
+ENTRY (__vfork)
+
+#ifdef __NR_vfork
+
+	DO_CALL (vfork, 0)
+#if 0
+	/* REVISIT */
+	PSEUDO_RET
+#endif
+#else
+	DO_CALL (fork, 0)
+#if 0
+	PSEUDO_RET
+#endif
+#endif
+
+PSEUDO_END (__vfork)
+libc_hidden_def (__vfork)
+
+weak_alias (__vfork, vfork)
diff --git a/sysdeps/unix/sysv/linux/microblaze/vfork.S b/sysdeps/unix/sysv/linux/microblaze/vfork.S
deleted file mode 100644
index ca99596..0000000
--- a/sysdeps/unix/sysv/linux/microblaze/vfork.S
+++ /dev/null
@@ -1,45 +0,0 @@
-/* The GNU C Library is free software; you can redistribute it and/or
-   modify it under the terms of the GNU Lesser General Public
-   License as published by the Free Software Foundation; either
-   version 2.1 of the License, or (at your option) any later version.
-
-   The GNU C Library is distributed in the hope that it will be useful,
-   but WITHOUT ANY WARRANTY; without even the implied warranty of
-   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
-   Lesser General Public License for more details.
-
-   You should have received a copy of the GNU Lesser General Public
-   License along with the GNU C Library; if not, write to the Free
-   Software Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA
-   02111-1307 USA.  */
-
-#include <sysdep.h>
-#define _ERRNO_H	1
-#include <bits/errno.h>
-#include <kernel-features.h>
-
-/* Clone the calling process, but without copying the whole address space.
-   The calling process is suspended until the new process exits or is
-   replaced by a call to `execve'.  Return -1 for errors, 0 to the new process,
-   and the process ID of the new process to the old process.  */
-
-ENTRY (__vfork)
-
-#ifdef __NR_vfork
-
-	DO_CALL (vfork, 0)
-#if 0
-	/* REVISIT */
-	PSEUDO_RET
-#endif
-#else
-	DO_CALL (fork, 0)
-#if 0
-	PSEUDO_RET
-#endif
-#endif
-
-PSEUDO_END (__vfork)
-libc_hidden_def (__vfork)
-
-weak_alias (__vfork, vfork)
-- 
1.7.1

