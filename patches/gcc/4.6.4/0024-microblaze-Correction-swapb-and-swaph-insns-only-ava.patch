From d1b9daeec2c202ecb0305ff461766e9cba694718 Mon Sep 17 00:00:00 2001
From: David Holsgrove <david.holsgrove@petalogix.com>
Date: Tue, 27 Mar 2012 18:26:20 +1000
Subject: [PATCH 24/79] microblaze: Correction - swapb and swaph insns only available from microblaze 8.30a +

Signed-off-by: David Holsgrove <david.holsgrove@petalogix.com>
---
 gcc/config/microblaze/microblaze.c |   10 +++++++---
 1 files changed, 7 insertions(+), 3 deletions(-)

diff --git a/gcc/config/microblaze/microblaze.c b/gcc/config/microblaze/microblaze.c
index 6816b5c..c1caaf3 100755
--- a/gcc/config/microblaze/microblaze.c
+++ b/gcc/config/microblaze/microblaze.c
@@ -1407,16 +1407,20 @@ microblaze_option_override (void)
 
   ver = MICROBLAZE_VERSION_COMPARE (microblaze_select_cpu, "v8.10.a");
   microblaze_has_clz = 1;
-  microblaze_has_swap = 1;
   if (ver < 0)
     {
         /* MicroBlaze prior to 8.10.a didn't have clz.  */
         microblaze_has_clz = 0;
-        /* MicroBlaze prior to 8.10a didn't have swapb or swaph insns. */
+    }
+  ver = MICROBLAZE_VERSION_COMPARE (microblaze_select_cpu, "v8.30.a");
+  microblaze_has_swap = 1;
+  if (ver < 0)
+    {
+        /* MicroBlaze prior to 8.30a didn't have swapb or swaph insns. */
         microblaze_has_swap = 0;
         if (TARGET_REORDER)
           warning (0,
-                 "-mxl-reorder can be used only with -mcpu=v8.10.a or greater");
+                 "-mxl-reorder can be used only with -mcpu=v8.30.a or greater");
     }
   if (TARGET_MULTIPLY_HIGH && TARGET_SOFT_MUL)
     error ("-mxl-multiply-high requires -mno-xl-soft-mul");
-- 
1.7.1

