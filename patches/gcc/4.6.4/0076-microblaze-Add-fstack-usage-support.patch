From ebf1620c60c1108599ad433c0632b3099f4a1c3d Mon Sep 17 00:00:00 2001
From: David Holsgrove <david.holsgrove@petalogix.com>
Date: Thu, 27 Sep 2012 17:08:20 +1000
Subject: [PATCH 76/79] microblaze: Add -fstack-usage support

Signed-off-by: David Holsgrove <david.holsgrove@petalogix.com>
---
 gcc/config/microblaze/microblaze.c |    3 +++
 1 files changed, 3 insertions(+), 0 deletions(-)

diff --git a/gcc/config/microblaze/microblaze.c b/gcc/config/microblaze/microblaze.c
index bc9c561..9e845e7 100755
--- a/gcc/config/microblaze/microblaze.c
+++ b/gcc/config/microblaze/microblaze.c
@@ -2963,6 +2963,9 @@ microblaze_expand_prologue (void)
 
   fsiz = compute_frame_size (get_frame_size ());
 
+  if (flag_stack_usage)
+    current_function_static_stack_size = fsiz;
+
   /* If this function is a varargs function, store any registers that
      would normally hold arguments ($5 - $10) on the stack.  */
   if (((TYPE_ARG_TYPES (fntype) != 0
-- 
1.7.1

